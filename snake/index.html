<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Snake Game â€“ Clean UI</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
  /* ---------- RESET & GLOBALS ---------- */
  *{margin:0;padding:0;box-sizing:border-box;}
  body{font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
       background:#121212; color:#e0e0e0;
       display:flex; flex-direction:column;
       align-items:center; justify-content:flex-start;
       min-height:100vh; overflow:hidden;}
  h1{margin-top:1rem; font-size:1.8rem;}
  /* ---------- GAME CONTAINER ---------- */
  #gameContainer{position:relative; margin-top:1rem;}
  canvas{border:4px solid #333; background:#1e1e1e;}
  /* ---------- UI OVERLAY ---------- */
  #overlay{
    position:absolute; top:0; left:0; right:0; bottom:0;
    background:rgba(0,0,0,0.7);
    display:flex; flex-direction:column;
    align-items:center; justify-content:center;
    color:#fff; text-align:center;
    font-size:1.4rem; gap:1rem;
    pointer-events:none; /* let clicks pass through unless we want a button */
  }
  #overlay.active{pointer-events:auto;}
  button{
    padding:.8rem 1.6rem; font-size:1rem;
    border:none; border-radius:4px;
    background:#ff5722; color:#fff;
    cursor:pointer; transition:.2s;
  }
  button:hover{background:#e64a19;}
  /* ---------- SCORE BOARD ---------- */
  #scoreBoard{
    display:flex; justify-content:space-between;
    width:100%; max-width:400px;
    margin-top:1rem; font-size:1rem;
  }
  #scoreBoard span{display:block;}
  /* ---------- INSTRUCTIONS ---------- */
  #instructions{
    position:absolute; bottom:1rem; left:50%;
    transform:translateX(-50%);
    background:rgba(0,0,0,0.8); padding:.5rem 1rem;
    border-radius:4px; font-size:1rem;
  }
  #instructions.hidden{display:none;}
</style>
</head>

<body>
<h1>ðŸŸ¢ Snake</h1>

<div id="scoreBoard">
  <span id="score">Score: 0</span>
  <span id="high">High: 0</span>
</div>

<div id="gameContainer">
  <canvas id="game"></canvas>
  <div id="overlay"></div>
  <div id="instructions">Use arrow keys, WASD or swipe. Tap to start.</div>
</div>

<script>
/* ---------------- CONFIG ---------------- */
const gridSize   = 20;            // px per cell
const cellCount  = 20;            // 20x20 board
const speed      = 200;           // ms per step
/* ---------------------------------------- */

/* ---------------- STATE ----------------- */
let snake      = [{x:9,y:9}];
let dir        = {x:0, y:-1};
let nextDir    = {...dir};
let food       = {x:0, y:0};
let paused     = false;
let lastTime   = 0;
let accumulated= 0;
let score      = 0;
let highScore  = 0;
/* ---------------------------------------- */

/* ------------ CANVAS & RESIZE ------------ */
const canvas = document.getElementById('game');
const ctx    = canvas.getContext('2d');

function resizeCanvas(){
  const scale = Math.min(window.innerWidth, window.innerHeight) - 30;
  const size  = cellCount * gridSize; // 400x400 css px
  canvas.width  = size * window.devicePixelRatio;
  canvas.height = size * window.devicePixelRatio;
  canvas.style.width  = size + 'px';
  canvas.style.height = size + 'px';
  ctx.setTransform(window.devicePixelRatio,0,0,
                   window.devicePixelRatio,0,0);
  placeFood();
}
window.addEventListener('resize', resizeCanvas);
resizeCanvas();

/* ---------------- FOOD ----------------- */
function placeFood(){
  let x, y, collision;
  do{
    x = Math.floor(Math.random()*cellCount);
    y = Math.floor(Math.random()*cellCount);
    collision = snake.some(s=>s.x===x && s.y===y);
  }while(collision);
  food = {x,y};
}

/* ------------- COLLISION ---------------- */
function isCollision(pos){
  if(pos.x<0||pos.x>=cellCount||pos.y<0||pos.y>=cellCount)return true;
  return snake.some(s=>s.x===pos.x && s.y===pos.y);
}

/* -------------- MOVE -------------------- */
function move(){
  const newHead = {x: snake[0].x+dir.x, y: snake[0].y+dir.y};
  if(isCollision(newHead)){
    paused = true;
    showOverlay('Game Over', 'Press Restart');
    return;
  }
  snake.unshift(newHead);
  if(newHead.x===food.x && newHead.y===food.y){
    score++;
    if(score>highScore){highScore=score; updateScore();}
    placeFood();
  }else{
    snake.pop();
  }
}

/* -------------- DRAW -------------------- */
function render(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  ctx.fillStyle='lime';
  snake.forEach(p=>ctx.fillRect(p.x*gridSize,p.y*gridSize,gridSize,gridSize));
  ctx.fillStyle='red';
  ctx.fillRect(food.x*gridSize,food.y*gridSize,gridSize,gridSize);
}

/* ----------------- LOOP ----------------- */
function loop(time){
  if(paused){lastTime=time; requestAnimationFrame(loop);return;}
  const delta= time-lastTime; lastTime=time; accumulated+=delta;
  while(accumulated>=speed){
    dir=nextDir; move(); accumulated-=speed;
  }
  render();
  requestAnimationFrame(loop);
}
requestAnimationFrame(loop);

/* ---------------- KEYBOARD ---------------- */
window.addEventListener('keydown', e=>{
  const k=e.key.toLowerCase();
  let newDir;
  if(k==='arrowup'||k==='w') newDir={x:0,y:-1};
  else if(k==='arrowdown'||k==='s') newDir={x:0,y:1};
  else if(k==='arrowleft'||k==='a') newDir={x:-1,y:0};
  else if(k==='arrowright'||k==='d') newDir={x:1,y:0};
  else return;
  // prevent 180Â° reversal
  if(newDir && !(newDir.x===-dir.x && newDir.y===-dir.y))
    nextDir={...newDir};
});

/* ----------------- TAP / SWIPE ------------- */
const gameContainer=document.getElementById('gameContainer');
let touchStart=null;
gameContainer.addEventListener('touchstart', e=>{
  touchStart={x:e.touches[0].clientX,y:e.touches[0].clientY};
});
gameContainer.addEventListener('touchend', e=>{
  if(!touchStart)return;
  const dx=e.changedTouches[0].clientX-touchStart.x;
  const dy=e.changedTouches[0].clientY-touchStart.y;
  if(Math.abs(dx)>Math.abs(dy)){
    nextDir={x:dx>0?1:-1,y:0};
  }else{
    nextDir={x:0,y:dy>0?1:-1};
  }
  touchStart=null;
  if(paused){paused=false; hideOverlay(); updateScore();}
});

/* ------------- SCORE UI ----------------- */
function updateScore(){
  document.getElementById('score').textContent=`Score: ${score}`;
  document.getElementById('high').textContent=`High: ${highScore}`;
}
function resetScore(){score=0; updateScore();}

/* ----------------- OVERLAY --------------- */
const overlay=document.getElementById('overlay');
function showOverlay(title,btnText){
  overlay.innerHTML=`<div>${title}</div>`;
  if(btnText){
    const btn=document.createElement('button');
    btn.textContent=btnText;
    btn.onclick=restartGame;
    overlay.appendChild(btn);
  }
  overlay.classList.add('active');
}
function hideOverlay(){
  overlay.classList.remove('active');
  overlay.innerHTML='';
}
function showInstructions(){document.getElementById('instructions').classList.remove('hidden');}
function hideInstructions(){document.getElementById('instructions').classList.add('hidden');}

/* ----------------- RESTART -------------- */
function restartGame(){
  snake=[{x:9,y:9}];
  dir={x:0,y:-1}; nextDir={...dir};
  paused=false; score=0; updateScore();
  hideOverlay(); hideInstructions();
  placeFood();
}

/* ------------- HIGHâ€‘SCORE STORAGE ------- */
// If you want persistence you can uncomment the next block.
// localStorage.getItem('snakeHigh') will be set on game over.
// localStorage.setItem('snakeHigh', highScore);

</script>
</body>
</html>
